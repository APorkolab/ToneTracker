import{a as t,i as v}from"./utils-CpYcuoze.js";import{u as S,s as T,a as A,c as L,b as D,d as b,e as _,f,h as w}from"./game-BlvZb4Jo.js";import{b as c,p as m,f as E,i as s,s as l,c as n,g,E as i,a as y,e as h}from"./features-WjIVO5NO.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))d(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&d(p)}).observe(document,{childList:!0,subtree:!0});function u(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(r){if(r.ep)return;r.ep=!0;const a=u(r);fetch(r.href,a)}})();function I(){t.newGameButton.addEventListener("click",()=>{y("game-start"),n(i.FEATURE_USED,{feature:"new-game-button"}),T(),h("game-start")}),t.checkButton.addEventListener("click",()=>{y("color-check"),n(i.FEATURE_USED,{feature:"check-color-button"}),L(),h("color-check")}),t.computerGuessButton.addEventListener("click",()=>{n(i.COMPUTER_TIP_USED,{feature:"computer-tip-button",difficulty:l.get("current_difficulty","medium")}),D()}),t.colorInput.addEventListener("input",()=>{const e="#"+t.colorInput.value.replace("#","");v(e)&&(b(e),n(i.FEATURE_USED,{feature:"color-input-typing",inputLength:t.colorInput.value.length}))}),t.colorAdjust.addEventListener("input",()=>{const e=t.colorAdjust.value;v(e)&&(t.colorInput.value=e.replace("#",""),b(e),_(e.replace("#","")),n(i.FEATURE_USED,{feature:"color-adjust-input"}))}),t.plusRedButton.addEventListener("click",()=>{f("r",1),n(i.FEATURE_USED,{feature:"rgb-adjust",component:"red",direction:"plus"})}),t.minusRedButton.addEventListener("click",()=>{f("r",-1),n(i.FEATURE_USED,{feature:"rgb-adjust",component:"red",direction:"minus"})}),t.plusGreenButton.addEventListener("click",()=>{f("g",1),n(i.FEATURE_USED,{feature:"rgb-adjust",component:"green",direction:"plus"})}),t.minusGreenButton.addEventListener("click",()=>{f("g",-1),n(i.FEATURE_USED,{feature:"rgb-adjust",component:"green",direction:"minus"})}),t.plusBlueButton.addEventListener("click",()=>{f("b",1),n(i.FEATURE_USED,{feature:"rgb-adjust",component:"blue",direction:"plus"})}),t.minusBlueButton.addEventListener("click",()=>{f("b",-1),n(i.FEATURE_USED,{feature:"rgb-adjust",component:"blue",direction:"minus"})}),t.difficulty.addEventListener("change",e=>{const o=e.target.value,u=l.get("current_difficulty","medium");A(o),l.set("current_difficulty",o),n(i.DIFFICULTY_CHANGE,{oldDifficulty:u,newDifficulty:o,feature:"difficulty-selector"}),console.log(`üéØ Difficulty changed: ${u} ‚Üí ${o}`)}),t.modalCloseButtons.forEach(e=>{e.addEventListener("click",()=>{w(),n(i.FEATURE_USED,{feature:"modal-close-button"})})}),t.resultModal.addEventListener("click",e=>{e.target===t.resultModal&&(w(),n(i.FEATURE_USED,{feature:"modal-backdrop-close"}))})}async function k(){try{y("app-initialization");const e=l.getUserPreferences();console.log("üìã Loading user preferences:",e),await s.initialize(e.language),console.log("üåç i18n initialized with language:",e.language),e.difficulty&&(t.difficulty.value=e.difficulty,A(e.difficulty));const o=document.getElementById("language-switcher-container");if(o){const u=s.createLanguageSwitcher((d,r)=>{const a=l.getUserPreferences();a.language=d,l.updateUserPreferences({language:d}),n(i.LANGUAGE_CHANGE,{oldLanguage:r,newLanguage:d}),U()});o.appendChild(u)}U(),h("app-initialization")}catch(e){console.error("‚ùå Failed to initialize i18n and preferences:",e),c.trackError(e,{context:"app-initialization"})}}function U(){try{t.newGameButton.textContent=s.t("ui.newGame"),t.checkButton.textContent=s.t("ui.checkColor"),t.computerGuessButton.textContent=s.t("ui.computerTip"),t.colorInput.placeholder=s.t("ui.colorInputPlaceholder");const e=t.difficulty.querySelectorAll("option");e.length>=3&&(e[0].textContent=s.t("difficulty.easy"),e[1].textContent=s.t("difficulty.medium"),e[2].textContent=s.t("difficulty.hard"));const o=document.getElementById("modal-title");o&&(o.textContent=s.t("ui.gameResult")),console.log("üî§ UI updated with translations")}catch(e){console.error("‚ùå Failed to update UI with translations:",e)}}function C(){try{g.start(),console.log("üìä Performance monitoring started"),setInterval(()=>{E.takeMemorySnapshot?.()},3e4),setInterval(()=>{const e=E.generateReport();console.log("üìà Performance Report:",e),e.summary.criticalIssues>0&&n(i.PERFORMANCE_ISSUE,{criticalIssues:e.summary.criticalIssues,warnings:e.summary.warnings})},3e5)}catch(e){console.error("‚ùå Failed to initialize performance monitoring:",e)}}function x(){try{const e=l.get("analytics_consent",null);if(e===null){const o=document.createElement("div");o.innerHTML=`
        <div style="position: fixed; bottom: 0; left: 0; right: 0; background: #f8f9fa; padding: 16px; border-top: 1px solid #dee2e6; z-index: 1000;">
          <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: between; gap: 16px;">
            <div style="flex: 1;">
              <p style="margin: 0; font-size: 14px;">üç™ ${s.t("privacy.analyticsConsent")||"We use analytics to improve your experience. No personal data is collected."}</p>
            </div>
            <div style="display: flex; gap: 8px;">
              <button id="accept-analytics" class="btn btn-primary btn-sm">Accept</button>
              <button id="decline-analytics" class="btn btn-secondary btn-sm">Decline</button>
            </div>
          </div>
        </div>
      `,document.body.appendChild(o),document.getElementById("accept-analytics").onclick=()=>{l.set("analytics_consent",!0),c.setEnabled(!0),o.remove(),console.log("‚úÖ Analytics consent granted")},document.getElementById("decline-analytics").onclick=()=>{l.set("analytics_consent",!1),c.setEnabled(!1),o.remove(),console.log("‚ùå Analytics consent declined")}}else c.setEnabled(e),console.log("üìä Analytics:",e?"enabled":"disabled")}catch(e){console.error("‚ùå Failed to initialize analytics:",e)}}async function R(){try{console.log("üöÄ ToneTracker v2.0.0 initializing..."),n(i.SESSION_START,{version:"2.0.0",timestamp:Date.now(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}}),await k(),I(),C(),x(),m&&await m.requestPersistentStorage(),console.log("‚úÖ App initialization complete"),S(),T(),n(i.FEATURE_USED,{feature:"app-initialization-complete",loadTime:performance.now()})}catch(e){console.error("‚ùå App initialization failed:",e),c.trackError(e,{context:"app-initialization"})}}function F(){window.addEventListener("beforeunload",()=>{n(i.SESSION_END,{sessionDuration:Date.now()-(window.sessionStartTime||Date.now()),timestamp:Date.now()}),c&&c.flush(!0)}),document.addEventListener("visibilitychange",()=>{document.hidden?(n(i.FEATURE_USED,{feature:"app-hidden"}),g.stop()):(n(i.FEATURE_USED,{feature:"app-visible"}),g.start())});let e;const o=300*1e3;function u(){clearTimeout(e),e=setTimeout(()=>{n(i.FEATURE_USED,{feature:"user-idle"})},o)}["mousedown","mousemove","keypress","scroll","touchstart"].forEach(d=>{document.addEventListener(d,u,!0)}),u()}window.addEventListener("error",e=>{console.error("üí• Global error:",e.error),c.trackError(e.error,{context:"global-error-handler",filename:e.filename,lineno:e.lineno,colno:e.colno})});window.addEventListener("unhandledrejection",e=>{console.error("üí• Unhandled promise rejection:",e.reason),c.trackError(new Error(e.reason),{context:"unhandled-promise-rejection"})});window.toneTracker={analytics:c,storage:l,i18n:s,performanceMonitor:E,pwaManager:m,version:"2.0.0"};window.sessionStartTime=Date.now();F();R();
//# sourceMappingURL=index-iubofqsH.js.map
